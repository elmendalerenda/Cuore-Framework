describe("Collapsable decorator", function()
{
	var aComponent;


	 beforeEach(function () {
	 	aComponent = new CollapsablePanel();
	 	aComponent.setRenderer(new CollapsableQuintRenderer())
	});

	
	it("change styles as intended when uncollapsing", function(){

		var container = createTestContainer();
		daRenderer=new CollapsableQuintRenderer();
		daRenderer.setUnCollapsingStyles({"background-color": "red","padding-top":"10px"}); 
		aComponent.setRenderer(daRenderer);
		
		aComponent.setContainer(container.get("id"));  
		
		aComponent.draw();
		aComponent.uncollapse();
	  
		var timeForTheAnimationToComplete = 300;
		waits(timeForTheAnimationToComplete);
		
		runs( function () {
			var DOMPanel = $(aComponent.getUniqueID());
			expect(DOMPanel.getStyle("background-color")).toEqual("red");
			expect(DOMPanel.getStyle("padding-top")).toEqual("10px");
		});
	});
	
	it("change styles as intended when collapsing", function(){

		var container = createTestContainer();
		daRenderer=new CollapsableQuintRenderer(); 
		daRenderer.setCollapsingStyles({"background-color": "blue","padding-top":"10px"});
		
		aComponent.setRenderer(daRenderer);
		
		aComponent.setContainer(container.get("id"));
		 	
	    
		aComponent.draw();
		
		aComponent.uncollapse();
		aComponent.collapse();
	  
		var timeForTheAnimationToComplete = 300;
		
		waits(timeForTheAnimationToComplete);		
		
		runs( function () {
			var DOMPanel = $(aComponent.getUniqueID());
			expect(DOMPanel.getStyle("background-color")).toEqual("blue");
			expect(DOMPanel.getStyle("padding-top")).toEqual("10px");		
		});
		
	});
	
	
	it("exists default uncollapse and collapse styles", function(){

		var timeForTheAnimationToComplete = 300;
		var container = createTestContainer();
		aComponent.setContainer(container.get("id"));
		daRenderer=new CollapsableQuintRenderer(); 
		daRenderer.setCollapsingStyles({"background-color": "blue","padding-top":"10px"});
		daRenderer.setUnCollapsingStyles({"background-color": "red","padding-top":"10px"});
		aComponent.setRenderer(daRenderer);
		  
		aComponent.draw();
		aComponent.uncollapse();	  
		waits(timeForTheAnimationToComplete);
		
		runs( function () {
			var DOMPanel = $(aComponent.getUniqueID());
			expect(DOMPanel.getStyle("background-color")).toEqual("red");
			expect(DOMPanel.getStyle("padding-top")).toEqual("10px");
			daRenderer.setUnCollapsingStyles(undefined); 
			aComponent.uncollapse();
	  		waits(timeForTheAnimationToComplete);	
	  		runs( function () {
	  				var DOMPanel = $(aComponent.getUniqueID());
	  				expect(DOMPanel.getStyle("padding-top")).toEqual("0px");
	  				
					aComponent.collapse();	  
					waits(timeForTheAnimationToComplete);
					runs( function () {
						var DOMPanel = $(aComponent.getUniqueID());
						expect(DOMPanel.getStyle("background-color")).toEqual("blue");
						expect(DOMPanel.getStyle("padding-top")).toEqual("10px");
						daRenderer.setCollapsingStyles(undefined); 
						aComponent.collapse();
						waits(timeForTheAnimationToComplete);	
						runs( function () {
								var DOMPanel = $(aComponent.getUniqueID());
								expect(DOMPanel.getStyle("padding-top")).toEqual("0px");
						});	
					});	
	  		});	
		});	
	});
	
	//TODO what happend with events?
	
	
	
	function createTestContainer()
	{
		$("xhtmlToTest").erase('html');
		var container = new Element('div', {
			"id" : "testingContainer"
		}).inject($("xhtmlToTest"));
		return container;
	};
	
	
	
	
});
