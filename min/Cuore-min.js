var Debuggable=new Class({debug:function(c){var a=(document.debugMode==true);var b=document.debugTypes&&(document.debugTypes[this.typeName]===true);if(a||b){console.log(c)}}});var Bus=new Class({Implements:Debuggable,initialize:function(){this.instanceName="Bus";this.typeName="Bus";this.subscriptions=[];document[this.instanceName]=document[this.instanceName]||this;return document[this.instanceName]},subscribe:function(b,a){if(!this.subscriptionExists(b,a)){this.subscriptions.push([b,a])}},subscribers:function(d){var b=[];for(var a=0,c;c=this.subscriptions[a];a++){if(c[1]===d){b.push(c[0])}}return b},hasSubscriptions:function(){return this.subscriptions.length>0},subscriptionExists:function(d,b){var a=false;var h=[d,b];for(var c=0,e;e=this.subscriptions[c];c++){var g=(e[0]===h[0]);var f=(e[1]===h[1]);if(g&&f){a=true;break}}return a},emit:function(a,e){var d=this.subscribers(a);this.debug("Bus.emit (event, params)");this.debug(a);this.debug(e);this.debug("------------");for(var b=0,c;c=d[b];b++){c.eventDispatch(a,e)}},unsubscribe:function(d,c){for(var b=0,a;a=c[b];b++){var e=[d,a];this.removeSubscription(e)}},removeSubscription:function(e){for(var a=0,b;b=this.subscriptions[a];a++){var d=(b[0]===e[0]);var c=(b[1]===e[1]);if(d&&c){this.subscriptions.splice(a,1)}}},reset:function(){this.subscriptions=[]}});var Service=new Class({initialize:function(){this.name="ABSTRACT";this.typeName="Service";this.executionPrefix="EXECUTED";this.SEPARATOR="_";this.lastDataSent=null;this.baseURL=""},execute:function(c,d,b){var a=this.getEventNameForExecution(c);this[c](d,a);if(!b){this.emit(a,d)}},request:function(b,c,a){new Request.JSON({url:b,data:{query:JSON.encode(c)},onComplete:function(d){this.emit(a,d)}.bind(this)}).send();this.lastDataSent=c},emit:function(a,b){this.getBus().emit(a,b)},getEventNameForExecution:function(a){return this.getName()+this.SEPARATOR+a+this.SEPARATOR+this.executionPrefix},getName:function(){return this.name},getLastDataSent:function(){return this.lastDataSent},getBaseURL:function(){return this.baseURL},setBaseURL:function(a){this.baseURL=a},getBus:function(){return new Bus()}});var Page=new Class({initialize:function(a){this.services={};this.components={};this.cleaners=[];document.page=this;this.baseURL=a||"";this.addService(new LabelsService());this.setUp()},initializeServices:function(){},initializeComponents:function(){},setUp:function(){this.initializeServices();this.initializeComponents()},addService:function(a){a.setBaseURL(this.getBaseURL());this.services[a.getName()]=a},getService:function(a){return this.services[a]||new NullService()},addComponent:function(b,a,c){this.subcribeComponentEvents(b);b.setName(this.generateUUID());this.components[b.getName()]=b;if(c){this.cleaners.push(b.getName())}b.setContainer(a)},subcribeComponentEvents:function(b){var d=b.getManagedEvents();for(var c=0,a;a=d[c];c++){(new Bus()).subscribe(b,a)}},draw:function(){for(var b in this.components){var a=this.getComponent(b);if(this.cleaners.indexOf(a.getName())>=0){this.$(a.getContainer()).innerHTML=""}a.draw()}},$:function(a){return document.getElementById(a)},getComponent:function(a){return this.components[a]||null},getBaseURL:function(){return this.baseURL},generateUUID:function(){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";var a=b.replace(/[xy]/g,function(e){var c=Math.random()*16|0,d=e==="x"?c:(c&3|8);return d.toString(16)});return a}});var Handler=new Class({initialize:function(){this.owner=null;this.typeName="Handler"},handle:function(a){},dispatch:function(a){this.handle(a)},setOwner:function(a){this.owner=a},getOwner:function(){return this.owner},getPage:function(){return document.page}});var NullService=new Class({Extends:Service,Implements:Debuggable,initialize:function(){this.typeName="NullService";this.name="NULL"},execute:function(b,c,a){this.debug("NullService.execute(procedure, params, asynchronous)");this.debug(b);this.debug(c);this.debug(a);this.debug("------------------------------------------------------")}});var LabelsService=new Class({Extends:Service,initialize:function(){this.parent();this.name="LABELS";this.typeName="LabelsService";this.cache=document.labels||{};this.setLocale(navigator.language||navigator.browserLanguage)},setLocale:function(a){if(!a){return}this.locale=a;this.cache[this.locale]=this.cache[this.locale]||{}},getLabel:function(g,b){var e=b+this.SEPARATOR+g.key;var d=this.fromCache(g.key);if(d){var a=[];a.answer=d;this.emit(e,a)}else{var f={LABEL_KEY:g.key,LOCALE:this.locale};var c=this.getBaseURL()+"labels/get";this.request(c,f,e)}},fromCache:function(a){return this.cache[this.locale][a]},emit:function(a,c){var b=this.extractKey(a);if(!b){return}c=c||{};this.cache[this.locale][b]=c.answer;if(!this.cache[this.locale][b]){c.answer=b}this.parent(a,c)},extractKey:function(a){var b=a.match(/_([a-zA-Z\.]*)$/),c=b?b[1]:null;return c}});var ButtonService=new Class({Extends:Service,initalize:function(){this.name="BUTTON";this.typeName="ButtonService";this.executionPrefix="CLICKED"},execute:function(b,c){c=c||{};c.buttonName=b;var a=this.name+this.SEPARATOR+b+this.SEPARATOR+this.executionPrefix;this.emit(a,c)}});var Renderer=new Class({initialize:function(){this.panel=null;this.panelClasses=["innerComponentDiv"];this.container=document.body},setContainer:function(a){this.container=a},getContainer:function(){return this.container},innerDivName:function(a){var b="_inner";return a+b},render:function(a){if(!this.isDrawn()){this.draw(a)}this.update(a)},draw:function(a){this.panel=new Element("div",{id:this.innerDivName(a.getName())}).inject(this.container);this.setCurrentClasses()},isDrawn:function(){return this.panel},update:function(a){if(this.isDrawn()){this.updateWhenDrawn(a)}},updateWhenDrawn:function(a){this.panel.set("text",a.getText())},erase:function(){var a=this.panel;if(a){$(a).destroy()}},setCurrentClasses:function(){for(var a=0,b;b=this.panelClasses[a];a++){this.panel.addClass(b)}},addClass:function(a){this.panelClasses.push(a);if(this.panel){this.panel.addClass(a)}},removeClass:function(a){this.panelClasses.erase(a);if(this.panel){this.panel.removeClass(a)}},getCurrentClasses:function(){return this.panelClasses},});var ExecutorHandler=new Class({Extends:Handler,initialize:function(a){this.typeName="ExecutorHandler";this.ownerFunction=a},handle:function(a){this.getOwner()[this.ownerFunction](a)}});var PrintHandler=new Class({Extends:Handler,initalize:function(){this.typeName="PrintHandler"},handle:function(){window.print()}});var SetTextHandler=new Class({Extends:Handler,Implements:Debuggable,initalize:function(){this.typeName="SetTextHandler"},handle:function(b){this.debug("SetTextHandler.handle(params)");this.debug(b);this.debug(this.getOwner());this.debug("----------------------------");if(b){var a=b.answer;this.getOwner().setText(a)}}});var Journey=new Class({initialize:function(c,b){var a=(c&&b);this.itsGranularity=60;this.minutesInAnHour=60;this.start=a?this.convertToMinutesDay(c):0;this.end=a?this.convertToMinutesDay(b):1440},starts:function(){return this._normalize(this.start)},ends:function(){return this._normalize(this.end)},granularity:function(){return this.itsGranularity},withGranularityOf:function(a){this.itsGranularity=parseInt(a)},_normalize:function(a){if(!isNaN(a)){return this.formatHour(a)}},convertToMinutesDay:function(b){var e=24;var a=this._parseHour(b);var c=this._parseMinutes(b);var f=(c>=this.minutesInAnHour)||(c<0);var d=(a>e)||(a<0);if(f||d){return null}return(a*this.minutesInAnHour)+c},_parseHour:function(a){return Number(this._getChunks(a)[0])},_parseMinutes:function(a){return ~~(this._getChunks(a)[1])},_getChunks:function(a){var a=a.toString();return a.split(":",2)},formatHour:function(c){var d=10;var a=Math.floor(c/this.minutesInAnHour);var c=c%this.minutesInAnHour;var e=c<d?"0"+c:c;var b=a<d?"0"+a:a;return b+":"+e},isValid:function(){return this.start<this.end},slots:function(){var f=[];var g=this.end-this.itsGranularity;var d=0;for(var c=this.start;c<=g;c+=this.itsGranularity){var e=this.formatHour(c);var b=this.formatHour(c+this.itsGranularity);f[d++]=new Journey(e,b)}var a=f[d-1].ends();if(a!==this.ends()){f[d]=new Journey(a,this.ends())}return f},toString:function(){return this.starts()+"-"+this.ends()},setStartTime:function(a){if(!a){return}this.start=this.convertToMinutesDay(a);if(this.start>=this.end){this.start=this.end-this.itsGranularity}},setEndTime:function(a){if(!a){return}this.end=this.convertToMinutesDay(a);if(this.end<=this.start){this.end=this.start+this.itsGranularity}}});var Component=new Class({initialize:function(){this.LABELSERVICENAME="LABELS";this.name="aComponent";this.typeName="Component";this.service="NULL";this.procedure="nullProcedure";this.I18NKey=null;this.handlers={};this.SEPARATOR="_";this.text="";this.renderer=new Renderer()},initializeExecutionContext:function(a,b){if(a&&b){this.service=a;this.procedure=b}},draw:function(){this.render();this.getLabel()},render:function(){this.renderer.render(this)},updateRender:function(){this.renderer.update(this)},destroy:function(){this.renderer.erase();var a=new Bus();a.unsubscribe(this,this.getManagedEvents())},execute:function(d,e,g,b){var c=d||this.service;var a=e||this.procedure;var f=this.getService(c);if(f){f.execute(a,g,b)}},eventDispatch:function(a,e){var d=this.handlers[a];console.log(d);if(!d){return}for(var b=0,c;c=d[b];b++){c.handle(e)}},addHandler:function(a,b){this.handlers[a]=this.handlers[a]||[];b.setOwner(this);this.handlers[a].push(b)},addDispatcher:function(a,b){this.addHandler(a,b)},addClass:function(a){this.renderer.addClass(a)},removeClass:function(a){this.renderer.removeClass(a)},getText:function(){return this.text},getTypeName:function(){return this.typeName},getName:function(){return this.name},setName:function(a){this.name=a},setContainer:function(a){this.renderer.setContainer(a)},getService:function(b){var a=b||this.service;return document.page.getService(a)||null},getLabelService:function(){return this.getService(this.LABELSERVICENAME)},getLabel:function(){if(!this.I18NKey||!this.getLabelService()){return}var a={key:this.I18NKey};this.getLabelService().execute("getLabel",a,true)},getUniqueID:function(){return this.renderer.innerDivName(this.name)},getManagedEvents:function(){var a=[];for(var b in this.handlers){a.push(b)}return a},setText:function(a){this.text=a;this.render()},setI18NKey:function(a){if(!a){return}this.I18NKey=a;this.addHandler("LABELS_getLabel_EXECUTED_"+a,new SetTextHandler());new Bus().subscribe(this,"LABELS_getLabel_EXECUTED_"+a)},getI18NKey:function(){return this.I18NKey},setRenderer:function(a){this.renderer=a}});var Input=new Class({Extends:Component,initialize:function(a,b){this.parent();this.setRenderer(new InputRenderer());this.setI18NKey(a);this.typeName="Input";this.type=b||"text";this.value="";this.disabled=false},setText:function(a){this.text=a},getValue:function(){return this.renderer.getValue()||this.value},setValue:function(a){this.value=a;this.updateRender()},disable:function(){this.disabled=true;this.updateRender()},enable:function(){this.disabled=false;this.updateRender()}});var InputRenderer=new Class({Extends:Renderer,draw:function(a){this.panel=new Element("div",{id:this.innerDivName(a.getName())}).inject(this.container);this.label=new Element("label",{});this.addClass("inputJS");this.DOMInput=new Element("input",{type:a.type}).inject(this.panel);this.label.inject(this.panel,"top")},updateWhenDrawn:function(a){this.label.set("text",a.getText());this.DOMInput.set("value",a.value);this.DOMInput.set("disabled",a.disabled);this.setCurrentClasses()},getValue:function(){if(this.isDrawn()){return this.DOMInput.get("value")}},});var Button=new Class({Extends:Component,initialize:function(a,b){this.parent();this.typeName="Button";this.service="BUTTON";this.procedure="aButton";this.BUTTONSERVICE="BUTTON";this.DOMClass="button";this.data=null;this.text="CLICK!";this.buttonName="aButton";this.enabled=true;this.asynchronous=false;this.renderer=new ButtonRenderer();this.initializeExecutionContext(this.BUTTONSERVICE,a);this.buttonName=this.procedure;this.setI18NKey(b)},click:function(){var a=this.getService();if(a){a.execute(this.buttonName,this.data)}},disable:function(){this.enabled=false;this.updateRender()},enable:function(){this.enabled=true;this.updateRender()},getButtonName:function(){return this.buttonName},setData:function(a){this.data=a},isEnable:function(){return this.enabled}});var ButtonRenderer=new Class({Extends:Renderer,draw:function(a){this.panel=new Element("a",{id:this.innerDivName(a.getName()),href:"#"}).inject(this.container);this.panel.addClass(a.getButtonName());this.span=new Element("span").inject(this.panel)},updateWhenDrawn:function(a){console.log("test");this.putText(a);this.setClassCSS(a);this.addEvents(a);this.setCurrentClasses()},putText:function(a){var b=a.getText()||a.getButtonName();this.span.set("text",b)},setClassCSS:function(b){var a="disabled";if(!b.isEnable()){this.addClass(a)}else{this.removeClass(a)}},addEvents:function(a){this.panel.removeEvents("click");if(a.isEnable()){this.panel.addEvent("click",function(b){if(b){b.stop()}});this.panel.addEvent("click",a.click.bind(a))}},});var TimeRange=new Class({Extends:Component,initialize:function(a,b){this.parent();this.typeName="TimeRange";this.label=null;this.startHourSelect=null;this.endHourSelect=null;this.setRenderer(new TimeRangeRenderer());this.journey=new Journey();if(b){this.journey.withGranularityOf(b)}this.setI18NKey(a)},setStartHour:function(a){var b=a||this.renderer.getStartTime();this.journey.setStartTime(b);this.updateRender();this.emitValues()},setEndHour:function(a){var b=a||this.renderer.getEndTime();this.journey.setEndTime(b);this.updateRender();this.emitValues()},setText:function(a){this.text=a;this.updateRender()},emitValues:function(){var a=this.getBus();var b={startHour:this.getStartHour(),endHour:this.getEndHour()};a.emit("COMPONENT_"+this.name+"_CHANGED",b)},getBus:function(){return new Bus()},getStartHour:function(){return this.journey.starts()},getEndHour:function(){return this.journey.ends()}});var TimeRangeRenderer=new Class({Extends:Renderer,initalize:function(){this.label=null;this.startHourSelect=null;this.endHourSelect=null},draw:function(a){this.parent(a);this.panel.erase("text");this.addClass("timeRange");this.label=new Element("label").inject(this.panel);this.startHourSelect=new Element("select",{"class":"hourSelect startHourSelect"}).inject(this.panel);this.startHourSelect.addEvent("change",a.setStartHour.bind(a));this.endHourSelect=new Element("select",{"class":"hourSelect endHourSelect"}).inject(this.panel);this.endHourSelect.addEvent("change",a.setEndHour.bind(a))},getStartTime:function(){return this.startHourSelect.get("value")},getEndTime:function(){return this.endHourSelect.get("value")},setOptions:function(a){this.constructStartOptions(a);this.constructEndOptions(a)},constructStartOptions:function(a){this.clearOptions(this.startHourSelect);var c=this.getSlots("00:00",a.journey.ends(),a.journey.granularity());for(var b=0,d;d=c[b];b++){new Element("option",{value:d.starts(),text:d.starts()}).inject(this.startHourSelect)}},constructEndOptions:function(a){this.clearOptions(this.endHourSelect);var c=this.getSlots(a.journey.starts(),"24:00",a.journey.granularity());for(var b=0,d;d=c[b];b++){new Element("option",{value:d.ends(),text:d.ends()}).inject(this.endHourSelect)}},getSlots:function(d,a,c){var b=new Journey(d,a);b.withGranularityOf(c);return b.slots()},clearOptions:function(b){var a=b.getChildren("option");for(var c=0,d;d=a[c];c++){d.destroy()}},updateWhenDrawn:function(a){this.label.set("text",a.getText());this.setOptions(a);this.startHourSelect.set("value",a.journey.starts());this.endHourSelect.set("value",a.journey.ends())},});var SwitchButton=new Class({Extends:Button,initialize:function(a,c,b){this.parent(a);this.typeName="SwitchButton";this.active=true;this.activeLabel=this.text;this.inactiveLabel=this.text;this.activeKey=c;this.inactiveKey=b;this.renderer=new SwitchButtonRenderer();this.addLabelHandler(this.activeKey,"setActiveLabel");this.addLabelHandler(this.inactiveKey,"setInactiveLabel")},addLabelHandler:function(a,b){this.addHandler("LABELS_getLabel_EXECUTED_"+a,new ExecutorHandler(b))},draw:function(){this.getLabel(this.activeKey);this.getLabel(this.inactiveKey);this.render()},click:function(a){var b=(a===undefined);if(a||b){this.parent()}this.switchState()},switchState:function(){this.active=!this.active;this.updateRender()},isActive:function(){return this.active},getLabel:function(a){if(!a){return}var c=this.getLabelService();var b={key:a};if(c){c.execute("getLabel",b,true)}},setActiveLabel:function(a){this.activeLabel=a.answer;this.updateRender()},setInactiveLabel:function(a){this.inactiveLabel=a.answer;this.updateRender()},getActiveLabel:function(){return this.activeLabel},getInactiveLabel:function(){return this.inactiveLabel},getActiveKey:function(){return this.activeKey},getInactiveKey:function(){return this.inactiveKey}});var SwitchButtonRenderer=new Class({Extends:ButtonRenderer,putText:function(a){if(a.isActive()){this._putActiveText(a)}else{this._putInactiveTexT(a)}},_putActiveText:function(b){var a=b.activeLabel;var c=b.activeKey;this._putText(a||c)},_putInactiveTexT:function(b){var a=b.inactiveLabel;var c=b.inactiveKey;this._putText(a||c)},_putText:function(a){this.span.set("text",a)},setClassCSS:function(c){this.parent(c);if(!this.panel){return}var d="off";var a="on";var e=c.active?a:d;var b=c.active?d:a;this.addClass(e);this.removeClass(b)},});var NumericSelector=new Class({Extends:Input,include:Debuggable,initialize:function(a){this.parent(a);this.typeName="NumericSelector";this.limSup=1e+24;this.limInf=0;this.incrementer=1;this.setRenderer(new NumericSelectorRenderer())},draw:function(){this.parent();this.setValue(this.getValue())},plus:function(){var a=parseInt(this.getValue())+this.incrementer;this.setValue(a)},minus:function(){var a=this.getValue()-this.incrementer;this.setValue(a)},setValue:function(a){var b=this.normalizeValue(a);this.parent(b);this.updateRender();this.notifyChanges()},normalizeValue:function(a){a=(a==="")?this.limInf:a;if(a==null){a=a||this.getValue()}a=this.checkLimits(a);a=this.snap(a);return a},checkLimits:function(b){var a=b;if(b>=this.limSup){a=this.limSup}if(b<=this.limInf){a=this.limInf}return a},snap:function(b){var a=parseInt(b/this.incrementer)*this.incrementer;return a},notifyChanges:function(){var a=this.getBus();var b={};b.value=this.getValue().toInt();a.emit("COMPONENT_"+this.name+"_CHANGED",b)},getBus:function(){return new Bus()},setLimSup:function(a){if(a<this.limInf){newlimSup=this.limInf}this.limSup=a;this.setValue(null)},getLimSup:function(){return this.limSup},setLimInf:function(a){if(a>this.limSup){a=this.limSup}this.limInf=a;this.setValue(null)},getLimInf:function(){return this.limInf},setIncrementer:function(a){this.incrementer=a},});var NumericSelectorRenderer=new Class({Extends:InputRenderer,initalize:function(){this.valueDisplayed=null},draw:function(a){this.parent(a);this.decorateInput();this.addMinusButton(a);this.addPlusButton(a)},addMinusButton:function(a){this.minusButton=new Element("a",{href:"#","class":"minusButton",html:"<span>-</span>"}).inject(this.panel);this.minusButton.addEvent("click",function(b){if(b){b.stop()}});this.minusButton.addEvent("click",a.minus.bind(a))},addPlusButton:function(a){this.plusButton=new Element("a",{href:"#","class":"plusButton",html:"<span>+</span>"}).inject(this.panel);this.plusButton.addEvent("click",function(b){if(b){b.stop()}});this.plusButton.addEvent("click",a.plus.bind(a))},decorateInput:function(){this.DOMInput.addClass("numericSelector");this.DOMInput.addEvent("focus",this.clearInput.bind(this));this.DOMInput.addEvent("blur",this.restoreInput.bind(this))},clearInput:function(){this.valueDisplayed=this.getValue();this.DOMInput.set("value","")},restoreInput:function(){var a=this.getValue();if(this.isIncorrect(a)||!this.isInteger(a)){a=this.valueDisplayed}this.DOMInput.set("value",a)},isIncorrect:function(c){var b=c.replace(/^\s+|\s+$/g,"");var a=isNaN(b);var d=(!b);return a||d},isInteger:function(c){var a=parseInt(c);if(isNaN(a)){return}var b=(a==c)&&(c.toString()===a.toString());return b},updateWhenDrawn:function(a){this.parent(a);this.checkDecorations(a)},checkDecorations:function(a){var b=parseInt(this.getValue());this.plusButton.removeClass("off");this.minusButton.removeClass("off");if((b+a.incrementer)>a.limSup){this.plusButton.addClass("off")}if((b-a.incrementer)<a.limInf){this.minusButton.addClass("off")}},});var SwitchCollapseAndUncollapseHandler=new Class({Extends:Handler,initialize:function(){this.typeName="SwitchCollapseAndUncollapseHandler"},handle:function(){if(this.owner.isCollapsed()){return this.owner.uncollapse()}this.owner.collapse()}});var CollapsablePanel=new Class({Extends:Component,initialize:function(a,b){this.parent(a,b);this.typeName="CollapsablePanel";this.collapsed=true;this.renderer=new CollapsableRenderer();this.addClass("collapsablePanel")},draw:function(){this.render()},isCollapsed:function(){return this.collapsed},uncollapse:function(){this.collapsed=false;this.updateRender()},collapse:function(){this.collapsed=true;this.updateRender()},});var CollapsableRenderer=new Class({Extends:Renderer,draw:function(a){this.panel=new Element("div",{id:this.innerDivName(a.getName())}).inject(this.container);this.panel.setStyles({height:"0px",overflow:"hidden","padding-top":"0px","padding-bottom":"0px"})},updateWhenDrawn:function(a){this.parent(a);this.collapseBehaviour(a);this.setCurrentClasses()},collapseBehaviour:function(b){var c="collapsed",a="uncollapsed";this.removeClass(c);this.removeClass(a);if(b.isCollapsed()){this.panel.setStyle("height","0px");this.addClass(c)}else{this.panel.setStyle("height",this.panel.getScrollSize().y);this.addClass(a)}},});var LabelPanel=new Class({Extends:Component,initialize:function(a){this.parent();this.typeName="LabelPanel";this.LABELSERVICENAME="LABELS";this.setI18NKey(a)},draw:function(){this.parent();this.addClass("labelPanel")}});var NumericSelectorRenderer=new Class({Extends:InputRenderer,initalize:function(){this.valueDisplayed=null},draw:function(a){this.parent(a);this.decorateInput();this.addMinusButton(a);this.addPlusButton(a)},addMinusButton:function(a){this.minusButton=new Element("a",{href:"#","class":"minusButton",html:"<span>-</span>"}).inject(this.panel);this.minusButton.addEvent("click",function(b){if(b){b.stop()}});this.minusButton.addEvent("click",a.minus.bind(a))},addPlusButton:function(a){this.plusButton=new Element("a",{href:"#","class":"plusButton",html:"<span>+</span>"}).inject(this.panel);this.plusButton.addEvent("click",function(b){if(b){b.stop()}});this.plusButton.addEvent("click",a.plus.bind(a))},decorateInput:function(){this.DOMInput.addClass("numericSelector");this.DOMInput.addEvent("focus",this.clearInput.bind(this));this.DOMInput.addEvent("blur",this.restoreInput.bind(this))},clearInput:function(){this.valueDisplayed=this.getValue();this.DOMInput.set("value","")},restoreInput:function(){var a=this.getValue();if(this.isIncorrect(a)||!this.isInteger(a)){a=this.valueDisplayed}this.DOMInput.set("value",a)},isIncorrect:function(c){var b=c.replace(/^\s+|\s+$/g,"");var a=isNaN(b);var d=(!b);return a||d},isInteger:function(c){var a=parseInt(c);if(isNaN(a)){return}var b=(a==c)&&(c.toString()===a.toString());return b},updateWhenDrawn:function(a){this.parent(a);this.checkDecorations(a)},checkDecorations:function(a){var b=parseInt(this.getValue());this.plusButton.removeClass("off");this.minusButton.removeClass("off");if((b+a.incrementer)>a.limSup){this.plusButton.addClass("off")}if((b-a.incrementer)<a.limInf){this.minusButton.addClass("off")}},});var NestableComponent=new Class({Extends:Component,hostedComponents:[],host:function(a){this.hostedComponents.push(a)},hosted:function(a){return this.hostedComponents},getManagedEvents:function(){var a=this.parent();for(var b=0,c;c=this.hostedComponents[b];b++){a.combine(c.getManagedEvents())}return a},eventDispatch:function(a,d){console.log("Before Super: "+this.handlers);this.parent(a,d);for(var b=0,c;c=this.hostedComponents[b];b++){c.eventDispatch(a,d)}},draw:function(){this.parent();for(var a=0,b;b=this.hostedComponents[a];a++){b.setContainer(this.$(this.renderer.innerDivName(this.name)));b.draw()}},$:function(a){return document.getElementById(a)},destroy:function(){for(var a=0,b;b=this.hostedComponents[a];a++){b.destroy()}this.parent()},setName:function(b){this.parent(b);var a=1;for(var c=0,d;d=this.hostedComponents[c];c++){d.setName(this.getName()+this.SEPARATOR+d.getName()+this.SEPARATOR+a);a++}},});